You are implementing a BRAND NEW CSV-based restore engine for the Spendory app.

THIS ENGINE COMPLETELY REPLACES ALL PREVIOUS RESTORE LOGIC.
DO NOT reuse, reference, or adapt any old restore code.

====================
INPUT
====================
- A ZIP file uploaded by the user
- ZIP contains CSV files created by the NEW export system
- CSV files may be empty
- CSV files may be missing (must be skipped safely)

====================
MANDATORY RESTORE ORDER
====================
1. categories.csv
2. accounts.csv
3. goals.csv
4. transactions.csv
5. budgets.csv
6. recurring.csv
7. settings.csv
8. onboarding.csv

====================
CSV VALIDATION RULES
====================
For each CSV:
- Validate the header row before reading any data
- If headers do not match expected columns → THROW an error
- If a CSV file is missing → SKIP it and log a warning
- If a row is invalid → log filename + row number + reason and ABORT restore

====================
ATOMIC RESTORE REQUIREMENT
====================
- Restore must be atomic
- Parse ALL CSV files into an in-memory staging object first
- Do NOT write anything to localStorage until all files are validated
- If any step fails → write NOTHING

====================
STORAGE RULES
====================
- Clear ONLY relevant spendory-* keys before committing restore
- Do NOT touch unrelated localStorage keys
- Write restored data ONLY to spendory-* keys
- Preserve IDs, dates, currencies, category IDs, account IDs exactly

====================
SAFETY LOCK
====================
- Set global flag: spendoryRestoreInProgress = true
- While true:
  - Block any default data seeding
  - Block context initialization
  - Block any non-restore writes to localStorage
- Clear the flag ONLY after successful restore

====================
IMPLEMENTATION DETAILS
====================
- Use a safe CSV parser
- Convert CSV rows into internal Spendory data structures
- Keep the logic clean, predictable, and synchronous where possible
- Do NOT reload the page
- Do NOT trigger UI updates here

====================
ERROR HANDLING
====================
- Fail loudly
- Log exact CSV filename and row number
- Never silently ignore bad data

Implement a clean, boring, reliable CSV restore engine only.
NO UI. NO CONTEXT LOGIC. NO SIDE EFFECTS.
